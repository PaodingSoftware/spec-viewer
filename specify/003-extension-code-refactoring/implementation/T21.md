# 实现记录 - T21

## 任务信息
- **编号**: T21
- **描述**: 合并 WebviewBase 和 WebviewUtils 为单一 WebviewUtils 类（保留实例方法和静态方法）

## 实现细节

### 修改的文件
- `extension/src/utils/webview-utils.js`

### 变更内容

#### 1. 合并 WebviewBase 类到 WebviewUtils 类

**原有结构**：
- `WebviewBase` 类：基类，包含 constructor、loadTemplate()、loadTemplates()、clearTemplateCache() 实例方法
- `WebviewUtils` 类：静态工具类，包含 escapeHtml()、renderTemplate() 静态方法

**合并后结构**：
- `WebviewUtils` 类：既包含实例方法也包含静态方法
  - 实例方法（原 WebviewBase）：constructor、loadTemplate()、loadTemplates()、clearTemplateCache()
  - 静态方法：escapeHtml()、renderTemplate()

**代码变更**：
```javascript
// 删除 WebviewBase 类定义，将其功能合并到 WebviewUtils
class WebviewUtils {
    // 实例构造函数和方法（原 WebviewBase）
    constructor(context) {
        this.context = context;
        this.templateCache = new Map();
    }

    async loadTemplate(templatePath) { /* ... */ }
    async loadTemplates(templateMap) { /* ... */ }
    clearTemplateCache() { /* ... */ }

    // 静态方法
    static escapeHtml(unsafe) { /* ... */ }
    static renderTemplate(template, variables) { /* ... */ }
}

// 导出更新
module.exports = { WebviewUtils };
```

### 优势
- 统一 webview 相关工具，所有功能集中在一个类
- 减少导入语句的重复（之前很多文件同时导入 WebviewBase 和 WebviewUtils）
- 简化继承关系，所有 Provider 只需继承 WebviewUtils

---
*创建时间: 2025-10-11*
