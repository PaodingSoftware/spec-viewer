# 实现记录 - A13

## 行动信息
- **编号**: A13
- **描述**: 从 viewer.js 中移除 escapeHtml() 函数定义，使用共享版本

## 实现细节

### 修改的文件
`extension/webview/viewer/viewer.js`

### 移除的内容
删除了文件末尾的 `escapeHtml()` 函数定义（约 9 行）：

```javascript
function escapeHtml(unsafe) {
    return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}
```

### 说明
- 该函数已移至 `extension/webview/shared/utils.js`
- viewer.html 在 viewer.js 之前加载 shared/utils.js，因此 escapeHtml 函数可直接使用
- viewer.js 中的 `escapeHtml(item.text)` 调用无需修改，直接使用全局函数
- 消除了前端代码重复，统一了工具函数管理

### 使用位置
viewer.js 中仍在第 111 行使用 `escapeHtml()` 函数：
```javascript
element.innerHTML = `<div class="outline-item-content">${escapeHtml(item.text)}</div>`;
```

---
*创建时间: 2025-10-11*
