# 实现记录 - A12

## 行动信息
- **编号**: A12
- **描述**: 实现手动刷新功能

## 实现细节

### 已在 A02 和 A07 中实现

手动刷新功能已在以下文件中实现：
- **后端**: `extension/src/providers/dashboard-provider.js` (A02)
- **前端**: `extension/webview/dashboard/dashboard.js` (A07)

### 实现位置

#### 1. 后端刷新逻辑

**文件**: `extension/src/providers/dashboard-provider.js`

**相关代码** (第 70-75 行):
```javascript
async handleMessage(message) {
    switch (message.command) {
        case 'refresh':
            await this.updatePanelContent();
            break;
        // ...
    }
}

async updatePanelContent() {
    if (!this.panel) return;
    const data = await this.parser.parseAll();
    this.panel.webview.postMessage({
        command: 'updateData',
        data: data
    });
}
```

#### 2. 前端刷新按钮

**文件**: `extension/webview/dashboard/dashboard.js`

**相关代码** (第 145-149 行):
```javascript
const refreshButton = document.getElementById('refreshButton');
if (refreshButton) {
    refreshButton.addEventListener('click', () => {
        vscode.postMessage({ command: 'refresh' });
    });
}
```

**HTML 按钮** (`dashboard.html` 第 14-16 行):
```html
<button id="refreshButton" class="icon-button" title="Refresh">
    <i class="fas fa-sync-alt"></i>
</button>
```

### 功能说明

1. **用户操作**: 点击标题栏的刷新按钮（同步图标）
2. **消息发送**: 前端发送 `refresh` 命令到后端
3. **数据重新解析**: 后端调用 `SenatusParser.parseAll()` 重新解析 `specify/` 目录
4. **数据更新**: 后端发送 `updateData` 消息到前端，携带最新数据
5. **视图刷新**: 前端调用 `renderDashboard()` 重新渲染界面

### 符合约束

- ✅ 混合方案：自动监控 + 手动刷新（符合讨论记录 D02）
- ✅ 使用 Font Awesome 图标 `fa-sync-alt`（符合讨论记录 D04）
- ✅ 消息通信机制（符合宪法 T02）

---
*创建时间: 2025-09-30*